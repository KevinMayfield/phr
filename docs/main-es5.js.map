{"version":3,"sources":["webpack:///src/app/tracking/tracking.component.ts","webpack:///src/app/tracking/tracking.component.html","webpack:///src/app/prescription-order-detail/prescription-order-detail.component.ts","webpack:///src/app/prescription-order-detail/prescription-order-detail.component.html","webpack:///src/app/orders/orders.component.ts","webpack:///src/app/orders/orders.component.html","webpack:///src/app/service/auth.service.ts","webpack:///src/app/eps-orders/prescription-orders.component.ts","webpack:///src/app/eps-orders/prescription-orders.component.html","webpack:///src/environments/environment.ts","webpack:///src/app/callback/callback.component.ts","webpack:///src/app/callback/callback.component.html","webpack:///node_modules/moment/locale sync ^\\.\\/.*$","webpack:///src/app/app.component.ts","webpack:///src/app/app.component.html","webpack:///src/app/app.module.ts","webpack:///src/app/service/FhirService.ts","webpack:///src/app/diary-entry/diary-entry.component.ts","webpack:///src/app/diary-entry/diary-entry.component.html","webpack:///src/app/service/auth-guard.ts","webpack:///src/app/service/nhsd.service.ts","webpack:///src/app/gp-diary/gp-diary.component.ts","webpack:///src/app/gp-diary/gp-diary.component.html","webpack:///src/app/app-routing.module.ts","webpack:///src/app/login/login.component.ts","webpack:///src/app/login/login.component.html","webpack:///src/app/main/main.component.ts","webpack:///src/app/main/main.component.html","webpack:///src/app/gp-prescriptions/prescription-refill.component.ts","webpack:///src/app/gp-prescriptions/prescription-refill.component.html","webpack:///src/main.ts","webpack:///$_lazy_route_resource lazy namespace object"],"names":["TrackingComponent","closed","basicFlavoredMarkdown","event","emit","ok","selector","templateUrl","styleUrls","PrescriptionOrderDetailComponent","_dialogService","nhsd","_viewContainerRef","task","displayedColumns","displayedDispenseColumns","datepipe","prescription","dispense","dataSource","dispenseDataSource","medicationRequest","subscribe","push","medicationDispense","console","log","nTask","resource","input","undefined","length","taskInput","valueReference","reference","display","getMedicationRequest","getMedicationDispense","OrdersComponent","dialog","disabled","error","operationOutcome","issue","details","text","msg","matDialogRef","openAlert","title","message","afterClosed","result","files","FileList","File","file","fileReader","FileReader","onloadend","e","bundle","JSON","parse","convertToTransaction","readAsText","selectEvent","Oauth2token","AuthService","router","http","accessToken","tokenChange","auth","authCode","bearerToken","headers","url","oauth2","token","urlParams","URLSearchParams","grant_type","append","document","baseURI","postAny","toString","smartToken","setAccessToken","body","httpHeaders","post","date","Date","expires_at","Math","round","valueOf","expires_in","localStorage","setItem","stringify","access_token","getAccessToken","getItem","helper","isTokenExpired","removeItem","decoded","hasOwnProperty","setUTCSeconds","offsetSeconds","getTokenExpirationDate","providedIn","PrescriptionOrdersComponent","hapi","data","queryTasks","taskChange","getTasks","dialogConfig","disableClose","autoFocus","id","open","openDraggable","component","dragHandleSelectors","config","panelClass","dragRefSubject","componentInstance","close","environment","production","cookie_domain","logonUrl","virtually","hapibase","firelybase","CallbackComponent","route","navigateByUrl","queryParamMap","params","code","get","performGetAccessToken","map","webpackContext","req","webpackContextResolve","__webpack_require__","o","Error","keys","webpackContextKeys","Object","resolve","module","exports","AppComponent","AppModule","provide","useValue","forRoot","declarations","imports","entryComponents","providers","bootstrap","FhirService","medicationRequests","medicationChange","tasks","getHeaders","entry","DragRef","DiaryEntryComponent","_document","formElements","name","hint","label","type","Select","selections","value","required","Text","min","setHours","reasonCode","coding","note","diaryForm","form","AuthGuard","NhsdService","resourceType","newBundle","status","intent","system","prescriptionorder","practitionerRole","fullUrl","medicationHeader","eventCoding","subject","identifier","authorizingPrescription","ident","groupIdentifier","requester","authoredOn","dispenseRequest","performer","owner","medicationCodeableConcept","getIdentifier","request","method","practitioner","GpDiaryComponent","fhir","diary","routes","path","canActivate","children","AppRoutingModule","LoginComponent","callback","MainComponent","opened","PrescriptionRefillComponent","source","queryMedicationRequests","getMedicationRequests","transform","bootstrapModule","err","webpackEmptyAsyncContext","Promise","then"],"mappings":"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","file":"main-es5.js","sourcesContent":["import {Component, EventEmitter, OnInit, Output} from '@angular/core';\n\n@Component({\n  selector: 'app-tracking',\n  templateUrl: './tracking.component.html',\n  styleUrls: ['./tracking.component.scss']\n})\nexport class TrackingComponent implements OnInit {\n\n  @Output() closed: EventEmitter<void> = new EventEmitter();\n\n  basicFlavoredMarkdown: string = `\n   ## GP FHIR MedicationRequests\n\n   Some GP suppliers have patient facing services with the concept of tracking. This is centred around the FP10 and includes:\n   - Patient asking for a refill\n   - GP authorizing refill\n   - Patient is informed the FP10 is ready for collection.\n   \n   ## Pharmacy FHIR MedicationDispense\n   \n   This is centred around the delivery of the medication and includes:\n   - medication is ready for collection\n   - medication has been dispatched.\n   \n   ## Notes\n   \n   In both cases these medication fulfilment tasks appear to be decoupled from the clinical medicinal FHIR resources. \n   \n   They are seperate atomic actions.\n `;\n\n  constructor() { }\n\n  ngOnInit(): void {\n  }\n  ok(event: any): void {\n      this.closed.emit();\n  }\n\n}\n","<td-window-dialog\n        [title]=\"'Tracking (FHIR Task)'\"\n        [toolbarColor]=\"'accent'\"\n        (close)=\"closed.emit()\"\n>\n    <mat-card>\n        <td-flavored-markdown>{{ basicFlavoredMarkdown }}</td-flavored-markdown>\n        <mat-card-actions>\n            <button mat-raised-button class=\"text-upper\" (click)=\"closed.emit()\">\n                Cancel\n            </button>\n            <button mat-raised-button class=\"text-upper\" (click)=\"ok($event)\">\n                Ok\n            </button>\n        </mat-card-actions>\n    </mat-card>\n</td-window-dialog>\n","import {Component, Inject, OnInit, ViewContainerRef} from '@angular/core';\nimport {MatTableDataSource} from \"@angular/material/table\";\nimport {TdDialogService} from \"@covalent/core/dialogs\";\nimport {MedicationDispense, MedicationRequest, Task} from 'fhir/r4';\nimport {MAT_DIALOG_DATA, MatDialogRef} from '@angular/material/dialog';\nimport {NhsdService} from \"../service/nhsd.service\";\nimport {DatePipe} from \"@angular/common\";\n\n@Component({\n  selector: 'app-prescription-order-detail',\n  templateUrl: './prescription-order-detail.component.html',\n  styleUrls: ['./prescription-order-detail.component.scss']\n})\nexport class PrescriptionOrderDetailComponent implements OnInit {\n\n\n    displayedColumns: string[] = ['authored', 'name', 'dosage', 'quantity', 'unit'];\n\n    displayedDispenseColumns: string[] = ['prepared', 'performer', 'name', 'quantity', 'unit'];\n\n    dataSource : any;\n    dispenseDataSource : any;\n\n    datepipe: DatePipe = new DatePipe('en-GB');\n\n    prescription: MedicationRequest[] =  [\n    ]\n\n    dispense: MedicationDispense[] =  [\n\n                ]\n    closed: any;\n\n  constructor(private _dialogService: TdDialogService,\n              private nhsd: NhsdService,\n              private _viewContainerRef: ViewContainerRef,\n              @Inject(MAT_DIALOG_DATA) public task: any\n  ) { }\n\n  ngOnInit(): void {\n      this.dataSource = new MatTableDataSource<any>(this.prescription);\n      this.dispenseDataSource = new MatTableDataSource<any>(this.dispense);\n\n      this.nhsd.medicationRequest.subscribe((medicationRequest: MedicationRequest) => {\n\n          this.prescription.push(medicationRequest);\n          this.dataSource = new MatTableDataSource<any>(this.prescription);\n      });\n      this.nhsd.medicationDispense.subscribe( (medicationDispense: MedicationDispense) => {\n          console.log(medicationDispense);\n          this.dispense.push(medicationDispense);\n          this.dispenseDataSource= new MatTableDataSource<any>(this.dispense);\n      })\n      const nTask: Task = this.task.resource;\n      if (nTask.input !== undefined && nTask.input.length>0) {\n          for (const taskInput of nTask.input) {\n              if (taskInput.valueReference !== undefined && taskInput.valueReference.reference !== undefined) {\n                  console.log(taskInput.valueReference.display)\n                  this.nhsd.getMedicationRequest(taskInput.valueReference.reference);\n                  this.nhsd.getMedicationDispense(taskInput.valueReference.reference);\n              }\n          }\n      }\n  }\n\n}\n","\n<mat-dialog-content>\n    <h2>Medication Requests</h2>\n<table mat-table [dataSource]=\"dataSource\" >\n\n        <ng-container matColumnDef=\"authored\">\n            <th mat-header-cell *matHeaderCellDef [style.width.px]=\"120\"> Authored </th>\n            <td mat-cell *matCellDef=\"let element\"> {{datepipe.transform(element.authoredOn, 'dd MMM yyyy HH:mm') }} </td>\n        </ng-container>\n        <ng-container matColumnDef=\"concept\">\n            <th mat-header-cell *matHeaderCellDef> Medication ID </th>\n            <td mat-cell *matCellDef=\"let element\"> {{element.concept}} </td>\n        </ng-container>\n\n    <ng-container matColumnDef=\"dosage\">\n        <th mat-header-cell *matHeaderCellDef [style.width.px]=\"300\"> Dose </th>\n        <td mat-cell *matCellDef=\"let element\"> {{element.dosageInstruction[0].text}} </td>\n    </ng-container>\n\n        <!-- Name Column -->\n        <ng-container matColumnDef=\"name\">\n            <th mat-header-cell *matHeaderCellDef [style.width.px]=\"300\"> Medication Name </th>\n            <td mat-cell *matCellDef=\"let element\"> {{element.medicationCodeableConcept.coding[0].display}} </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"quantity\">\n            <th mat-header-cell *matHeaderCellDef> Quantity </th>\n            <td mat-cell *matCellDef=\"let element\"> {{element.dispenseRequest.quantity.value}} </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"unit\">\n            <th mat-header-cell *matHeaderCellDef> Unit </th>\n            <td mat-cell *matCellDef=\"let element\"> {{element.dispenseRequest.quantity.unit}} </td>\n        </ng-container>\n\n        <tr mat-header-row *matHeaderRowDef=\"displayedColumns\"></tr>\n        <tr mat-row *matRowDef=\"let row; columns: displayedColumns;\"></tr>\n    </table>\n\n\n    <h2>Dispensing History</h2>\n\n    <table mat-table [dataSource]=\"dispenseDataSource\">\n\n        <ng-container matColumnDef=\"prepared\">\n            <th mat-header-cell *matHeaderCellDef [style.width.px]=\"140\"> Prepared </th>\n            <td mat-cell *matCellDef=\"let element\"> {{datepipe.transform(element.whenPrepared, 'dd MMM yyyy HH:mm') }} </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"concept\">\n            <th mat-header-cell *matHeaderCellDef> Medication ID </th>\n            <td mat-cell *matCellDef=\"let element\"> {{element.concept}} </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"performer\">\n            <th mat-header-cell *matHeaderCellDef> Pharmacy </th>\n            <td mat-cell *matCellDef=\"let element\">\n                <ul>\n                    <ng-template ngFor let-item [ngForOf]=\"element.performer\" let-i=\"index\" >\n                        <li>{{item.actor.display}}</li>\n                    </ng-template>\n                </ul>\n            </td>\n        </ng-container>\n\n        <!-- Name Column -->\n        <ng-container matColumnDef=\"name\">\n            <th mat-header-cell *matHeaderCellDef> Medication Name </th>\n            <td mat-cell *matCellDef=\"let element\"> {{element.medicationCodeableConcept.coding[0].display}} </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"quantity\">\n            <th mat-header-cell *matHeaderCellDef> Quantity </th>\n            <td mat-cell *matCellDef=\"let element\"> {{element.quantity.value}} </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"unit\">\n            <th mat-header-cell *matHeaderCellDef> Unit </th>\n            <td mat-cell *matCellDef=\"let element\"> {{element.quantity.unit}} </td>\n        </ng-container>\n\n        <!-- Symbol Column -->\n        <ng-container matColumnDef=\"status\">\n            <th mat-header-cell *matHeaderCellDef> Status </th>\n            <td mat-cell *matCellDef=\"let element\"> {{element.status}} </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"cancel_dispense\">\n            <th mat-header-cell *matHeaderCellDef> Cancel </th>\n            <td mat-cell *matCellDef=\"let element\">\n                <button mat-icon-button matTooltip=\"This is the ETPWithdrawal interaction. Does not map well to FHIR \"><mat-icon>assignment_return</mat-icon>Cancel Dispense</button>\n            </td>\n        </ng-container>\n\n        <tr mat-header-row *matHeaderRowDef=\"displayedDispenseColumns\"></tr>\n        <tr mat-row *matRowDef=\"let row; columns: displayedDispenseColumns;\"></tr>\n    </table>\n</mat-dialog-content>\n<mat-dialog-actions>\n    <button mat-button mat-dialog-close>Cancel</button>\n    <!-- The mat-dialog-close directive optionally accepts a value as a result for the dialog. -->\n</mat-dialog-actions>\n\n\n\n\n","import {Component, EventEmitter, OnInit} from '@angular/core';\nimport {Bundle, OperationOutcome} from 'fhir/r4';\nimport {NhsdService} from '../service/nhsd.service';\nimport {MatDialog} from \"@angular/material/dialog\";\nimport {TdDialogService} from \"@covalent/core/dialogs\";\n\n\n@Component({\n  selector: 'app-orders',\n  templateUrl: './orders.component.html',\n  styleUrls: ['./orders.component.scss']\n})\nexport class OrdersComponent implements OnInit {\n\n  files: File | FileList | undefined;\n  disabled = false;\n\n  constructor(\n      private nhsd: NhsdService,\n      private dialog: MatDialog,\n      private _dialogService: TdDialogService\n  ) { }\n\n  ngOnInit(): void {\n    this.nhsd.error.subscribe(\n        (error: OperationOutcome) => {\n          console.log(error);\n           const operationOutcome = error as OperationOutcome;\n           console.log(operationOutcome.issue[0].details?.text);\n          // @ts-ignore\n            const msg :string = operationOutcome.issue[0].details?.text;\n          // @ts-ignore\n            const matDialogRef = this._dialogService.openAlert({\n            title: 'Error',\n            message: msg\n          });\n          matDialogRef.afterClosed().subscribe(result => {\n            //console.log(matDialogRef.componentInstance.value);\n          });\n        }\n    )\n  }\n\n  // https://stackoverflow.com/questions/40214772/file-upload-in-angular\n\n  selectEvent(files: FileList | File): void {\n    if (files instanceof FileList) {\n      console.log('is filelist');\n    } else if (files instanceof File) {\n      console.log('is file');\n      const file: File = files;\n      const fileReader: FileReader = new FileReader();\n      // tslint:disable-next-line:only-arrow-functions typedef\n      fileReader.onloadend = (e) => {\n        if (typeof fileReader.result === 'string') {\n          const bundle = JSON.parse(fileReader.result) as Bundle;\n          this.nhsd.convertToTransaction(bundle);\n        }\n      };\n      fileReader.readAsText(file);\n    } else {\n      console.log('not a file type');\n    }\n  }\n\n\n}\n","<mat-card>\n   <!-- <h2>COVID-19 Vaccinations History</h2>\n    <br/> -->\n\n\n    <app-prescription-orders></app-prescription-orders>\n    <app-gp-diary></app-gp-diary>\n    <app-prescription-refill source=\"EPS\"></app-prescription-refill>\n    <app-prescription-refill source=\"GP\"></app-prescription-refill>\n\n    <br />\n    <div>\n\n        <td-file-input [(ngModel)]=\"files\" color=\"primary\" (select)=\"selectEvent($event)\"\n                       accept=\".json,.xml\">\n            <mat-icon>attach_file</mat-icon><span>Choose a FHIR Bundle file...</span>\n        </td-file-input>\n\n    </div>\n</mat-card>\n","\n\nimport {environment} from '../../environments/environment';\n\nimport {HttpClient, HttpHeaders} from '@angular/common/http';\nimport {EventEmitter, Injectable} from '@angular/core';\nimport {Router} from '@angular/router';\nimport {JwtHelperService} from '@auth0/angular-jwt';\n\n\n\nclass Oauth2token {\n}\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class AuthService {\n    private smartToken: Oauth2token | undefined;\n\n    private accessToken = undefined;\n\n    tokenChange: EventEmitter<Oauth2token> = new EventEmitter();\n\n   public auth = false;\n\n  constructor(\n             private router: Router,\n             private http: HttpClient\n              ) {\n\n  }\n\n    performGetAccessToken(authCode: string | null): any {\n\n\n    // https://digital.nhs.uk/developer/guides-and-documentation/security-and-authorisation/user-restricted-restful-apis-nhs-cis2-combined-authentication-and-authorisation\n\n    const bearerToken = '';\n    // 'Basic ' + btoa(environment.oauth2.client_id + ':' + environment.oauth2.client_secret);\n    const headers = new HttpHeaders( { 'Content-Type': 'application/x-www-form-urlencoded'});\n\n    const url = environment.oauth2.token;\n\n\n    const urlParams = new URLSearchParams(\n            { grant_type: 'authorization_code'});\n\n    // urlParams.append('client_id', environment.oauth2.client_id),\n    // urlParams.append(  'client_secret', environment.oauth2.client_secret);\n    urlParams.append(  'redirect_uri', document.baseURI + 'callback');\n    if (typeof authCode === 'string') {\n        urlParams.append('code', authCode);\n    }\n\n    this.postAny(url, urlParams.toString(),  headers  ).subscribe( (token: any) => {\n        // console.log(response);\n        this.smartToken = token;\n        console.log('OAuth2Token : ' + token);\n        this.setAccessToken(token);\n\n        }\n      , (error: any) => {\n        console.log(error);\n      }\n      , () => {\n        // Emit event\n      }\n    );\n  }\n\n    // tslint:disable-next-line:typedef\n    public postAny(url: string | null, body: string, httpHeaders: HttpHeaders) {\n        return this.http.post<any>(url as string, body, {headers: httpHeaders});\n    }\n\n    public setAccessToken(token: { expires_at: any; expires_in: number; access_token: any; }): any {\n        // tslint:disable-next-line:new-parens\n        const date = new Date;\n        // Create an expires at ..... don't know when we got the token\n        token.expires_at = Math.round((new Date().valueOf()) / 1000) + token.expires_in;\n        localStorage.setItem('nhsdToken', JSON.stringify(token));\n        this.accessToken = token.access_token;\n        this.tokenChange.emit(token);\n    }\n    public hasAccessToken(): boolean {\n        return this.getAccessToken() !== undefined;\n    }\n\n    public getAccessToken(): any {\n        if (localStorage.getItem('nhsdToken') !== undefined) {\n            const token: any = JSON.parse(localStorage.getItem('nhsdToken') as any);\n            const helper = new JwtHelperService();\n            if (this.isTokenExpired(token)) {\n\n                console.log('withings Token expired');\n                this.accessToken = undefined;\n                //  this.getRefreshToken();\n                return undefined;\n            }\n            if (token !== undefined) {\n                this.accessToken = token.access_token;\n                return this.accessToken;\n            }\n        }\n        return undefined;\n    }\n\n\n    private deleteAccessToken(): any {\n        this.accessToken = undefined;\n        localStorage.removeItem('nhsdToken');\n    }\n\n    private getTokenExpirationDate(\n        decoded: any\n    ): Date | null {\n\n        if (!decoded || !decoded.hasOwnProperty('expires_at')) {\n            // Invalid format\n            localStorage.removeItem('nhsdToken');\n            return null;\n        }\n\n        const date = new Date(0);\n        date.setUTCSeconds(decoded.expires_at);\n\n        return date;\n    }\n\n    private isTokenExpired(\n        token: any,\n        offsetSeconds?: number\n    ): boolean {\n        if (!token || token === '') {\n            return true;\n        }\n        const date = this.getTokenExpirationDate(token);\n        offsetSeconds = offsetSeconds || 0;\n\n        console.log('nhsd token expiry date ' + date);\n        if (date === null) {\n            return false;\n        }\n        return !(date.valueOf() > new Date().valueOf() + offsetSeconds * 1000);\n    }\n}\n","import { Component, OnInit } from '@angular/core';\nimport {MatTableDataSource} from '@angular/material/table';\nimport {MatDialog,MatDialogConfig} from '@angular/material/dialog';\nimport {NhsdService} from '../service/nhsd.service';\nimport {Task} from 'fhir/r4';\nimport {DatePipe} from \"@angular/common\";\nimport {PrescriptionOrderDetailComponent} from \"../prescription-order-detail/prescription-order-detail.component\";\nimport {IDraggableRefs, TdDialogService} from \"@covalent/core/dialogs\";\nimport {TrackingComponent} from \"../tracking/tracking.component\";\n\n@Component({\n  selector: 'app-prescription-orders',\n  templateUrl: './prescription-orders.component.html',\n  styleUrls: ['./prescription-orders.component.scss']\n})\nexport class PrescriptionOrdersComponent implements OnInit {\n\n\n    datepipe: DatePipe = new DatePipe('en-GB');\n    displayedColumns: string[] = ['authored', 'status', 'requester', 'pharmacy', 'medications', 'order_number',  'view_order', 'track_order'];\n\n    dataSource: any;\n    data: Task[] = [];\n\n\n\n  constructor(private hapi: NhsdService,\n              private dialog: MatDialog,\n              private _dialogService: TdDialogService) { }\n\n  ngOnInit(): void {\n     this.dataSource = new MatTableDataSource <any>(this.data);\n     this.hapi.queryTasks();\n     this.hapi.taskChange.subscribe(() => {\n          this.dataSource = new MatTableDataSource(this.hapi.getTasks());\n      });\n  }\n\n  view(resource: any): void {\n      const dialogConfig = new MatDialogConfig();\n\n      dialogConfig.disableClose = true;\n      dialogConfig.autoFocus = true;\n      dialogConfig.data = {\n          id: 1,\n          resource: resource\n      };\n      this.dialog.open( PrescriptionOrderDetailComponent, dialogConfig);\n\n  }\n\n    tracking(event: any): void {\n        const {\n            matDialogRef,\n            dragRefSubject,\n        }: IDraggableRefs<TrackingComponent> = this._dialogService.openDraggable({\n            component: TrackingComponent,\n            dragHandleSelectors: ['mat-toolbar'],\n            config: {\n                panelClass: ['td-window-dialog'], // pass this class in to ensure certain css is properly added,\n            },\n        });\n\n        matDialogRef.componentInstance.closed.subscribe(() => matDialogRef.close());\n    }\n\n}\n","<mat-card>\n    <mat-card-header><h2>EPS Prescription Orders (FHIR Task)</h2>\n\n    </mat-card-header>\n    <table mat-table [dataSource]=\"dataSource\" width=\"100%\" >\n\n        <!--- Note that these columns can be defined in any order.\n              The actual rendered columns are set as a property on the row definition\" -->\n\n        <ng-container matColumnDef=\"status\">\n            <th mat-header-cell *matHeaderCellDef [style.width.px]=\"80\"> Status </th>\n            <td mat-cell *matCellDef=\"let element\"> {{element.status}} </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"medications\">\n            <th mat-header-cell *matHeaderCellDef> Medications </th>\n            <td mat-cell *matCellDef=\"let element\">\n                <ul>\n                    <ng-template ngFor let-item [ngForOf]=\"element.input\" let-i=\"index\" >\n                        <li>{{item.valueReference.display}}</li>\n                    </ng-template>\n                </ul>\n            </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"pharmacy\">\n            <th mat-header-cell *matHeaderCellDef> Pharmacy </th>\n            <td mat-cell *matCellDef=\"let element\"> {{element.owner?.identifier.value}} </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"requester\">\n            <th mat-header-cell *matHeaderCellDef [style.width.px]=\"120\"> Requester </th>\n            <td mat-cell *matCellDef=\"let element\"> {{element.requester.display}} </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"authored\">\n            <th mat-header-cell *matHeaderCellDef [style.width.px]=\"120\"> Authored </th>\n            <td mat-cell *matCellDef=\"let element\"> {{datepipe.transform(element.authoredOn, 'dd MMM yyyy HH:mm') }} </td>\n        </ng-container>\n\n        <!-- Symbol Column -->\n        <ng-container matColumnDef=\"order_number\">\n            <th mat-header-cell *matHeaderCellDef > Order No. </th>\n            <td mat-cell *matCellDef=\"let element\"> {{element.identifier[0].value}} </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"return_order\">\n            <th mat-header-cell *matHeaderCellDef [style.width.px]=\"120\"> Cancel </th>\n            <td mat-cell *matCellDef=\"let element\">\n                <button color=\"warn\" *ngIf=\"element.status == 'accepted'\" mat-icon-button><mat-icon>remove_shopping_cart</mat-icon>Cancel</button>\n            </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"view_order\">\n            <th mat-header-cell *matHeaderCellDef [style.width.px]=\"120\"> View Order  </th>\n            <td mat-cell *matCellDef=\"let element\">\n                <button color=\"accent\" mat-icon-button (click)=\"view(element)\" ><mat-icon>inventory</mat-icon>View Details</button>\n            </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"track_order\">\n            <th mat-header-cell *matHeaderCellDef [style.width.px]=\"120\"> Tracking  </th>\n            <td mat-cell *matCellDef=\"let element\">\n                <button color=\"accent\" mat-icon-button ><mat-icon (click)=\"tracking($event)\"> local_shipping</mat-icon>Tracking</button>\n            </td>\n        </ng-container>\n\n        <tr mat-header-row *matHeaderRowDef=\"displayedColumns\"></tr>\n        <tr mat-row *matRowDef=\"let row; columns: displayedColumns;\"></tr>\n    </table>\n</mat-card>\n","// This file can be replaced during build by using the `fileReplacements` array.\n// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.\n// The list of file replacements can be found in `angular.json`.\n\nexport const environment = {\n  production: false,\n  oauth2 : {\n    token : 'https://int.api.service.nhs.uk/oauth2-no-smartcard/token',\n    auth : 'https://int.api.service.nhs.uk/oauth2-no-smartcard/authorize',\n    cookie_domain : 'localhost',\n    logonUrl: 'http://localhost:4200/ccri-logon'\n  },\n  virtually: 'https://test-emis.virtually.healthcare/R4',\n  nhsd: 'https://server.fire.ly/r4',\n  hapibase: 'http://hapi.fhir.org/baseR4',\n  firelybase : 'https://server.fire.ly/r4'\n};\n\n/*\n * For easier debugging in development mode, you can import the following file\n * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.\n *\n * This import should be commented out in production mode because it will have a negative impact\n * on performance if an error is thrown.\n */\n// import 'zone.js/dist/zone-error';  // Included with Angular CLI.\n","import { Component, OnInit } from '@angular/core';\nimport {ActivatedRoute, Router} from '@angular/router';\nimport {AuthService} from '../service/auth.service';\n\n@Component({\n  selector: 'app-callback',\n  templateUrl: './callback.component.html',\n  styleUrls: ['./callback.component.css']\n})\nexport class CallbackComponent implements OnInit {\n\n  constructor(private route: ActivatedRoute,\n              private auth: AuthService,\n              private router: Router) { }\n\n  private authCode = '' ;\n\n  subOAuth2: any;\n\n  // tslint:disable-next-line:typedef\n  ngOnInit() {\n\n    this.auth.tokenChange.subscribe(\n        () => {\n          this.router.navigateByUrl('/');\n        }\n    );\n    this.route.queryParamMap.subscribe(params => {\n      console.log(params);\n      const code = params.get('code');\n      // var state = params.get('state');\n      this.auth.performGetAccessToken(code);\n    });\n\n  }\n\n}\n","callback done\n","var map = {\n\t\"./af\": \"K/tc\",\n\t\"./af.js\": \"K/tc\",\n\t\"./ar\": \"jnO4\",\n\t\"./ar-dz\": \"o1bE\",\n\t\"./ar-dz.js\": \"o1bE\",\n\t\"./ar-kw\": \"Qj4J\",\n\t\"./ar-kw.js\": \"Qj4J\",\n\t\"./ar-ly\": \"HP3h\",\n\t\"./ar-ly.js\": \"HP3h\",\n\t\"./ar-ma\": \"CoRJ\",\n\t\"./ar-ma.js\": \"CoRJ\",\n\t\"./ar-sa\": \"gjCT\",\n\t\"./ar-sa.js\": \"gjCT\",\n\t\"./ar-tn\": \"bYM6\",\n\t\"./ar-tn.js\": \"bYM6\",\n\t\"./ar.js\": \"jnO4\",\n\t\"./az\": \"SFxW\",\n\t\"./az.js\": \"SFxW\",\n\t\"./be\": \"H8ED\",\n\t\"./be.js\": \"H8ED\",\n\t\"./bg\": \"hKrs\",\n\t\"./bg.js\": \"hKrs\",\n\t\"./bm\": \"p/rL\",\n\t\"./bm.js\": \"p/rL\",\n\t\"./bn\": \"kEOa\",\n\t\"./bn-bd\": \"loYQ\",\n\t\"./bn-bd.js\": \"loYQ\",\n\t\"./bn.js\": \"kEOa\",\n\t\"./bo\": \"0mo+\",\n\t\"./bo.js\": \"0mo+\",\n\t\"./br\": \"aIdf\",\n\t\"./br.js\": \"aIdf\",\n\t\"./bs\": \"JVSJ\",\n\t\"./bs.js\": \"JVSJ\",\n\t\"./ca\": \"1xZ4\",\n\t\"./ca.js\": \"1xZ4\",\n\t\"./cs\": \"PA2r\",\n\t\"./cs.js\": \"PA2r\",\n\t\"./cv\": \"A+xa\",\n\t\"./cv.js\": \"A+xa\",\n\t\"./cy\": \"l5ep\",\n\t\"./cy.js\": \"l5ep\",\n\t\"./da\": \"DxQv\",\n\t\"./da.js\": \"DxQv\",\n\t\"./de\": \"tGlX\",\n\t\"./de-at\": \"s+uk\",\n\t\"./de-at.js\": \"s+uk\",\n\t\"./de-ch\": \"u3GI\",\n\t\"./de-ch.js\": \"u3GI\",\n\t\"./de.js\": \"tGlX\",\n\t\"./dv\": \"WYrj\",\n\t\"./dv.js\": \"WYrj\",\n\t\"./el\": \"jUeY\",\n\t\"./el.js\": \"jUeY\",\n\t\"./en-au\": \"Dmvi\",\n\t\"./en-au.js\": \"Dmvi\",\n\t\"./en-ca\": \"OIYi\",\n\t\"./en-ca.js\": \"OIYi\",\n\t\"./en-gb\": \"Oaa7\",\n\t\"./en-gb.js\": \"Oaa7\",\n\t\"./en-ie\": \"4dOw\",\n\t\"./en-ie.js\": \"4dOw\",\n\t\"./en-il\": \"czMo\",\n\t\"./en-il.js\": \"czMo\",\n\t\"./en-in\": \"7C5Q\",\n\t\"./en-in.js\": \"7C5Q\",\n\t\"./en-nz\": \"b1Dy\",\n\t\"./en-nz.js\": \"b1Dy\",\n\t\"./en-sg\": \"t+mt\",\n\t\"./en-sg.js\": \"t+mt\",\n\t\"./eo\": \"Zduo\",\n\t\"./eo.js\": \"Zduo\",\n\t\"./es\": \"iYuL\",\n\t\"./es-do\": \"CjzT\",\n\t\"./es-do.js\": \"CjzT\",\n\t\"./es-mx\": \"tbfe\",\n\t\"./es-mx.js\": \"tbfe\",\n\t\"./es-us\": \"Vclq\",\n\t\"./es-us.js\": \"Vclq\",\n\t\"./es.js\": \"iYuL\",\n\t\"./et\": \"7BjC\",\n\t\"./et.js\": \"7BjC\",\n\t\"./eu\": \"D/JM\",\n\t\"./eu.js\": \"D/JM\",\n\t\"./fa\": \"jfSC\",\n\t\"./fa.js\": \"jfSC\",\n\t\"./fi\": \"gekB\",\n\t\"./fi.js\": \"gekB\",\n\t\"./fil\": \"1ppg\",\n\t\"./fil.js\": \"1ppg\",\n\t\"./fo\": \"ByF4\",\n\t\"./fo.js\": \"ByF4\",\n\t\"./fr\": \"nyYc\",\n\t\"./fr-ca\": \"2fjn\",\n\t\"./fr-ca.js\": \"2fjn\",\n\t\"./fr-ch\": \"Dkky\",\n\t\"./fr-ch.js\": \"Dkky\",\n\t\"./fr.js\": \"nyYc\",\n\t\"./fy\": \"cRix\",\n\t\"./fy.js\": \"cRix\",\n\t\"./ga\": \"USCx\",\n\t\"./ga.js\": \"USCx\",\n\t\"./gd\": \"9rRi\",\n\t\"./gd.js\": \"9rRi\",\n\t\"./gl\": \"iEDd\",\n\t\"./gl.js\": \"iEDd\",\n\t\"./gom-deva\": \"qvJo\",\n\t\"./gom-deva.js\": \"qvJo\",\n\t\"./gom-latn\": \"DKr+\",\n\t\"./gom-latn.js\": \"DKr+\",\n\t\"./gu\": \"4MV3\",\n\t\"./gu.js\": \"4MV3\",\n\t\"./he\": \"x6pH\",\n\t\"./he.js\": \"x6pH\",\n\t\"./hi\": \"3E1r\",\n\t\"./hi.js\": \"3E1r\",\n\t\"./hr\": \"S6ln\",\n\t\"./hr.js\": \"S6ln\",\n\t\"./hu\": \"WxRl\",\n\t\"./hu.js\": \"WxRl\",\n\t\"./hy-am\": \"1rYy\",\n\t\"./hy-am.js\": \"1rYy\",\n\t\"./id\": \"UDhR\",\n\t\"./id.js\": \"UDhR\",\n\t\"./is\": \"BVg3\",\n\t\"./is.js\": \"BVg3\",\n\t\"./it\": \"bpih\",\n\t\"./it-ch\": \"bxKX\",\n\t\"./it-ch.js\": \"bxKX\",\n\t\"./it.js\": \"bpih\",\n\t\"./ja\": \"B55N\",\n\t\"./ja.js\": \"B55N\",\n\t\"./jv\": \"tUCv\",\n\t\"./jv.js\": \"tUCv\",\n\t\"./ka\": \"IBtZ\",\n\t\"./ka.js\": \"IBtZ\",\n\t\"./kk\": \"bXm7\",\n\t\"./kk.js\": \"bXm7\",\n\t\"./km\": \"6B0Y\",\n\t\"./km.js\": \"6B0Y\",\n\t\"./kn\": \"PpIw\",\n\t\"./kn.js\": \"PpIw\",\n\t\"./ko\": \"Ivi+\",\n\t\"./ko.js\": \"Ivi+\",\n\t\"./ku\": \"JCF/\",\n\t\"./ku.js\": \"JCF/\",\n\t\"./ky\": \"lgnt\",\n\t\"./ky.js\": \"lgnt\",\n\t\"./lb\": \"RAwQ\",\n\t\"./lb.js\": \"RAwQ\",\n\t\"./lo\": \"sp3z\",\n\t\"./lo.js\": \"sp3z\",\n\t\"./lt\": \"JvlW\",\n\t\"./lt.js\": \"JvlW\",\n\t\"./lv\": \"uXwI\",\n\t\"./lv.js\": \"uXwI\",\n\t\"./me\": \"KTz0\",\n\t\"./me.js\": \"KTz0\",\n\t\"./mi\": \"aIsn\",\n\t\"./mi.js\": \"aIsn\",\n\t\"./mk\": \"aQkU\",\n\t\"./mk.js\": \"aQkU\",\n\t\"./ml\": \"AvvY\",\n\t\"./ml.js\": \"AvvY\",\n\t\"./mn\": \"lYtQ\",\n\t\"./mn.js\": \"lYtQ\",\n\t\"./mr\": \"Ob0Z\",\n\t\"./mr.js\": \"Ob0Z\",\n\t\"./ms\": \"6+QB\",\n\t\"./ms-my\": \"ZAMP\",\n\t\"./ms-my.js\": \"ZAMP\",\n\t\"./ms.js\": \"6+QB\",\n\t\"./mt\": \"G0Uy\",\n\t\"./mt.js\": \"G0Uy\",\n\t\"./my\": \"honF\",\n\t\"./my.js\": \"honF\",\n\t\"./nb\": \"bOMt\",\n\t\"./nb.js\": \"bOMt\",\n\t\"./ne\": \"OjkT\",\n\t\"./ne.js\": \"OjkT\",\n\t\"./nl\": \"+s0g\",\n\t\"./nl-be\": \"2ykv\",\n\t\"./nl-be.js\": \"2ykv\",\n\t\"./nl.js\": \"+s0g\",\n\t\"./nn\": \"uEye\",\n\t\"./nn.js\": \"uEye\",\n\t\"./oc-lnc\": \"Fnuy\",\n\t\"./oc-lnc.js\": \"Fnuy\",\n\t\"./pa-in\": \"8/+R\",\n\t\"./pa-in.js\": \"8/+R\",\n\t\"./pl\": \"jVdC\",\n\t\"./pl.js\": \"jVdC\",\n\t\"./pt\": \"8mBD\",\n\t\"./pt-br\": \"0tRk\",\n\t\"./pt-br.js\": \"0tRk\",\n\t\"./pt.js\": \"8mBD\",\n\t\"./ro\": \"lyxo\",\n\t\"./ro.js\": \"lyxo\",\n\t\"./ru\": \"lXzo\",\n\t\"./ru.js\": \"lXzo\",\n\t\"./sd\": \"Z4QM\",\n\t\"./sd.js\": \"Z4QM\",\n\t\"./se\": \"//9w\",\n\t\"./se.js\": \"//9w\",\n\t\"./si\": \"7aV9\",\n\t\"./si.js\": \"7aV9\",\n\t\"./sk\": \"e+ae\",\n\t\"./sk.js\": \"e+ae\",\n\t\"./sl\": \"gVVK\",\n\t\"./sl.js\": \"gVVK\",\n\t\"./sq\": \"yPMs\",\n\t\"./sq.js\": \"yPMs\",\n\t\"./sr\": \"zx6S\",\n\t\"./sr-cyrl\": \"E+lV\",\n\t\"./sr-cyrl.js\": \"E+lV\",\n\t\"./sr.js\": \"zx6S\",\n\t\"./ss\": \"Ur1D\",\n\t\"./ss.js\": \"Ur1D\",\n\t\"./sv\": \"X709\",\n\t\"./sv.js\": \"X709\",\n\t\"./sw\": \"dNwA\",\n\t\"./sw.js\": \"dNwA\",\n\t\"./ta\": \"PeUW\",\n\t\"./ta.js\": \"PeUW\",\n\t\"./te\": \"XLvN\",\n\t\"./te.js\": \"XLvN\",\n\t\"./tet\": \"V2x9\",\n\t\"./tet.js\": \"V2x9\",\n\t\"./tg\": \"Oxv6\",\n\t\"./tg.js\": \"Oxv6\",\n\t\"./th\": \"EOgW\",\n\t\"./th.js\": \"EOgW\",\n\t\"./tk\": \"Wv91\",\n\t\"./tk.js\": \"Wv91\",\n\t\"./tl-ph\": \"Dzi0\",\n\t\"./tl-ph.js\": \"Dzi0\",\n\t\"./tlh\": \"z3Vd\",\n\t\"./tlh.js\": \"z3Vd\",\n\t\"./tr\": \"DoHr\",\n\t\"./tr.js\": \"DoHr\",\n\t\"./tzl\": \"z1FC\",\n\t\"./tzl.js\": \"z1FC\",\n\t\"./tzm\": \"wQk9\",\n\t\"./tzm-latn\": \"tT3J\",\n\t\"./tzm-latn.js\": \"tT3J\",\n\t\"./tzm.js\": \"wQk9\",\n\t\"./ug-cn\": \"YRex\",\n\t\"./ug-cn.js\": \"YRex\",\n\t\"./uk\": \"raLr\",\n\t\"./uk.js\": \"raLr\",\n\t\"./ur\": \"UpQW\",\n\t\"./ur.js\": \"UpQW\",\n\t\"./uz\": \"Loxo\",\n\t\"./uz-latn\": \"AQ68\",\n\t\"./uz-latn.js\": \"AQ68\",\n\t\"./uz.js\": \"Loxo\",\n\t\"./vi\": \"KSF8\",\n\t\"./vi.js\": \"KSF8\",\n\t\"./x-pseudo\": \"/X5v\",\n\t\"./x-pseudo.js\": \"/X5v\",\n\t\"./yo\": \"fzPg\",\n\t\"./yo.js\": \"fzPg\",\n\t\"./zh-cn\": \"XDpg\",\n\t\"./zh-cn.js\": \"XDpg\",\n\t\"./zh-hk\": \"SatO\",\n\t\"./zh-hk.js\": \"SatO\",\n\t\"./zh-mo\": \"OmwH\",\n\t\"./zh-mo.js\": \"OmwH\",\n\t\"./zh-tw\": \"kOpN\",\n\t\"./zh-tw.js\": \"kOpN\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"RnhZ\";","import { Component } from '@angular/core';\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.scss']\n})\nexport class AppComponent {\n  title = 'phr';\n}\n","<router-outlet></router-outlet>","import { NgModule } from '@angular/core';\nimport { BrowserModule } from '@angular/platform-browser';\n\nimport { AppRoutingModule } from './app-routing.module';\nimport { AppComponent } from './app.component';\nimport {CovalentDynamicFormsModule} from \"@covalent/dynamic-forms\";\nimport {CovalentLayoutModule} from \"@covalent/core/layout\";\nimport {CovalentStepsModule} from \"@covalent/core/steps\";\nimport {CovalentHighlightModule} from \"@covalent/highlight\";\nimport {CovalentMarkdownModule} from \"@covalent/markdown\";\nimport {CovalentBaseEchartsModule} from \"@covalent/echarts/base\";\nimport {CovalentHttpModule} from \"@covalent/http\";\nimport { BrowserAnimationsModule } from '@angular/platform-browser/animations';\nimport {MainComponent} from \"./main/main.component\";\nimport {MatChipsModule} from \"@angular/material/chips\";\nimport {MatTooltipModule} from \"@angular/material/tooltip\";\nimport {MatTableModule} from \"@angular/material/table\";\nimport {CovalentDataTableModule} from \"@covalent/core/data-table\";\nimport {MatButtonModule} from \"@angular/material/button\";\nimport {MatIconModule} from \"@angular/material/icon\";\nimport {MatMenuModule} from \"@angular/material/menu\";\nimport {MatCardModule} from \"@angular/material/card\";\nimport {MatList, MatListModule} from \"@angular/material/list\";\nimport {FlexLayoutModule} from \"@angular/flex-layout\";\nimport { OrdersComponent } from './orders/orders.component';\nimport {PrescriptionRefillComponent} from \"./gp-prescriptions/prescription-refill.component\";\nimport {PrescriptionOrderDetailComponent} from \"./prescription-order-detail/prescription-order-detail.component\";\nimport {CovalentMessageModule} from \"@covalent/core/message\";\nimport {PrescriptionOrdersComponent} from \"./eps-orders/prescription-orders.component\";\nimport {CallbackComponent} from \"./callback/callback.component\";\nimport {AuthGuard} from \"./service/auth-guard\";\nimport { LoginComponent } from './login/login.component';\nimport {CovalentFileModule} from \"@covalent/core/file\";\nimport {FormsModule, ReactiveFormsModule} from \"@angular/forms\";\nimport {GpDiaryComponent} from \"./gp-diary/gp-diary.component\";\nimport {CovalentDialogsModule} from \"@covalent/core/dialogs\";\nimport {MatDialogModule} from '@angular/material/dialog';\nimport { DiaryEntryComponent } from './diary-entry/diary-entry.component';\nimport {MatFormFieldModule} from \"@angular/material/form-field\";\nimport {MatDatepickerModule} from \"@angular/material/datepicker\";\nimport {MatMomentDateModule} from \"@angular/material-moment-adapter\";\nimport {MAT_DATE_LOCALE} from \"@angular/material/core\";\nimport { TrackingComponent } from './tracking/tracking.component';\nimport {CovalentFlavoredMarkdownModule} from \"@covalent/flavored-markdown\";\n\n@NgModule({\n  declarations: [\n    AppComponent,\n    MainComponent,\n    OrdersComponent,\n      PrescriptionRefillComponent,\n      PrescriptionOrdersComponent,\n      GpDiaryComponent,\n      CallbackComponent,\n      LoginComponent,\n      PrescriptionOrderDetailComponent,\n      DiaryEntryComponent,\n      TrackingComponent\n  ],\n    imports: [\n        BrowserModule,\n        AppRoutingModule,\n        FlexLayoutModule,\n        BrowserAnimationsModule,\n\n        CovalentLayoutModule,\n        CovalentStepsModule,\n        // (optional) Additional Covalent Modules imports\n        CovalentHttpModule.forRoot(),\n        CovalentHighlightModule,\n        CovalentMarkdownModule,\n        CovalentDynamicFormsModule,\n        CovalentBaseEchartsModule,\n        CovalentMessageModule,\n        CovalentDialogsModule,\n        CovalentFlavoredMarkdownModule,\n\n        MatIconModule,\n        MatButtonModule,\n        CovalentDataTableModule,\n        MatMenuModule,\n        MatListModule,\n        MatCardModule,\n        MatTableModule,\n        MatTooltipModule,\n        MatChipsModule,\n        CovalentFileModule,\n        ReactiveFormsModule,\n        FormsModule,\n        MatDialogModule,\n        MatFormFieldModule,\n        MatDatepickerModule,\n        MatMomentDateModule\n\n    ],\n    entryComponents: [\n        PrescriptionOrderDetailComponent\n    ],\n  providers: [\n      AuthGuard,\n      {provide: MAT_DATE_LOCALE\n          , useValue: 'en-GB'},\n\n  ],\n  bootstrap: [AppComponent]\n})\nexport class AppModule { }\n","import {EventEmitter, Injectable} from '@angular/core';\nimport {AuthService} from './auth.service';\nimport {HttpClient, HttpHeaders} from '@angular/common/http';\nimport {Bundle, MedicationRequest, Task} from 'fhir/r4';\nimport {environment} from '../../environments/environment';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class FhirService {\n\n    private medicationRequests: MedicationRequest[] = [];\n\n\n    medicationChange: EventEmitter<any> = new EventEmitter();\n    constructor(private http: HttpClient,\n                private auth: AuthService) {\n    }\n\n    taskChange: EventEmitter<any> = new EventEmitter();\n    private tasks: Task[] = [];\n\n    public getTasks(): Task[] {\n        return this.tasks;\n    }\n\n    public queryTasks(): any {\n\n\n        const headers = this.getHeaders();\n        // tslint:disable-next-line:typedef\n        this.http.get(environment.virtually + '/Task?patient=137', { headers}).subscribe(\n            result => {\n                const bundle = result as Bundle;\n                if (bundle.entry !== undefined && bundle.entry.length > 0) {\n                    console.log('Task found.');\n                    this.tasks = [];\n                    for (const entry of bundle.entry) {\n                        this.tasks.push(entry.resource as Task);\n                    }\n                    this.taskChange.emit({});\n                } else {\n                    console.log('Task not found.');\n                }\n            }\n        );\n    }\n\n\n    public getMedicationRequests(): MedicationRequest[] {\n        return this.medicationRequests;\n    }\n    public queryMedicationRequests(): any {\n\n        const headers = this.getHeaders();\n        // tslint:disable-next-line:typedef\n        this.http.get(environment.virtually + '/MedicationRequest?patient=137&date=2019-01-01', { headers}).subscribe(\n            result => {\n                const bundle = result as Bundle;\n                if (bundle.entry !== undefined && bundle.entry.length > 0) {\n                    this.medicationRequests = [];\n                    for (const entry of bundle.entry) {\n                        this.medicationRequests.push(entry.resource as MedicationRequest);\n                    }\n                    this.medicationChange.emit({});\n                } else {\n                    console.log('Medication not found.');\n                }\n            }\n        );\n    }\n\n    getHeaders(): HttpHeaders {\n\n        let headers = new HttpHeaders(\n        );\n\n        headers = headers.append('Content-Type', 'application/fhir+json');\n        headers = headers.append('Accept', 'application/fhir+json');\n        // headers = headers.append(\"Authorization\", \"Bearer \"+this.auth.getAccessToken());\n        return headers;\n    }\n}\n","import {Component, EventEmitter, Inject, OnInit, Output, ViewChild} from '@angular/core';\nimport {TdDialogService} from \"@covalent/core/dialogs\";\nimport {DOCUMENT} from \"@angular/common\";\nimport {MAT_DIALOG_DATA} from \"@angular/material/dialog\";\nimport {\n  ITdDynamicElementConfig,\n  TdDynamicElement,\n  TdDynamicFormsComponent,\n  TdDynamicType\n} from \"@covalent/dynamic-forms\";\nimport {Task} from 'fhir/r4';\n\nclass DragRef {\n}\n\n@Component({\n  selector: 'app-diary-entry',\n  templateUrl: './diary-entry.component.html',\n  styleUrls: ['./diary-entry.component.scss']\n})\nexport class DiaryEntryComponent implements OnInit {\n  @Output() closed: EventEmitter<void> = new EventEmitter();\n\n  @ViewChild('diaryForm', { static: true }) diaryForm: TdDynamicFormsComponent | undefined;\n\n  formElements: ITdDynamicElementConfig[] = [\n\n    {\n      name: 'valueLabelSelect',\n      hint: 'this is a SNOMED concept (procedure codes)',\n      label: 'diary/task reason',\n      type: TdDynamicElement.Select,\n      selections: [\n        { label: 'Renewal of prescription', value: '103742009' },\n        { label: 'Review of medication', value: '182836005' },\n        { label: 'Asthma medication review', value: '394720003' }\n      ],\n      default : '103742009',\n      required: true,\n    },\n    {\n      name: 'description',\n      label: 'Notes',\n      type: TdDynamicType.Text,\n      required: true\n    },\n    {\n      name: 'dateInput',\n      label: 'Select a due by date',\n      hint: 'this is a datepicker hint',\n      type: TdDynamicType.Date,\n      required: true,\n      min: new Date(2021, 11, 1).setHours(0, 0, 0, 0),\n    },\n  ];\n  constructor(private _dialogService: TdDialogService,\n              @Inject(DOCUMENT) private _document: any,\n              @Inject(MAT_DIALOG_DATA) public task: Task) {\n\n  }\n\n  ngOnInit(): void {\n    console.log(this.task);\n    if (this.task.reasonCode !== undefined && this.task.reasonCode.coding != undefined) {\n      this.formElements[0].default = this.task.reasonCode.coding[0].code;\n    }\n    if (this.task.note !== undefined && this.task.note.length > 0) {\n      this.formElements[1].default = this.task.note[0].text;\n    }\n  }\n\n  ok(event: any): void {\n    if (this.diaryForm !== undefined) {\n      console.log(this.diaryForm.form.value);\n      console.log(this.task);\n    }\n  }\n\n}\n","<td-window-dialog\n        [title]=\"'Create Diary Entry (FHIR Task)'\"\n        [toolbarColor]=\"'accent'\"\n        (close)=\"closed.emit()\"\n>\n    <mat-card>\n    <td-dynamic-forms #diaryForm [elements]=\"formElements\" >\n\n    </td-dynamic-forms>\n\n        <mat-card-actions>\n        <button mat-raised-button class=\"text-upper\" (click)=\"closed.emit()\">\n            Cancel\n        </button>\n    <button mat-raised-button class=\"text-upper\" (click)=\"ok($event)\">\n        Ok\n    </button>\n        </mat-card-actions>\n    </mat-card>\n</td-window-dialog>\n","import {CanActivate, Router} from '@angular/router';\nimport {Injectable} from '@angular/core';\nimport {AuthService} from './auth.service';\nimport {Extension, MedicationRequest, Patient} from \"fhir/r4\";\n\n@Injectable()\nexport class AuthGuard  implements CanActivate {\n\n\n  constructor(public router: Router, private auth: AuthService) {\n\n  }\n  canActivate(): any {\n    return true;\n\n    /*\n    if (this.auth.hasAccessToken()) {\n      return true;\n    } else {\n        console.log('Auth');\n        this.router.navigate(['login']);\n        return false;\n    }\n     */\n  }\n\n}\n","import {EventEmitter, Injectable} from '@angular/core';\nimport {\n  Bundle,\n  BundleEntry,\n  DomainResource,\n  Identifier,\n  MedicationRequest,\n  MessageHeader,\n  PractitionerRole,\n  Task\n} from 'fhir/r4';\nimport {HttpClient, HttpHeaders} from '@angular/common/http';\nimport {environment} from \"../../environments/environment\";\nimport {AuthService} from \"./auth.service\";\nimport {MedicationDispense} from 'fhir/r4';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class NhsdService {\n\n  medicationChange: EventEmitter<any> = new EventEmitter();\n  public medicationRequest: EventEmitter<MedicationRequest> = new EventEmitter();\n  public medicationDispense: EventEmitter<MedicationDispense> = new EventEmitter();\n  error: EventEmitter<any> = new EventEmitter();\n  constructor(private http: HttpClient) { }\n  private medicationRequests: MedicationRequest[] = [];\n\n  taskChange: EventEmitter<any> = new EventEmitter();\n  private tasks: Task[] = [];\n  public getTasks(): Task[] {\n    return this.tasks;\n  }\n\n  public getMedicationRequests(): MedicationRequest[] {\n    return this.medicationRequests;\n  }\n\n  public queryTasks(): any {\n\n\n    const headers = this.getHeaders();\n    // tslint:disable-next-line:typedef\n    this.http.get(environment.nhsd + '/Task?patient.identifier=9876543210', { headers}).subscribe(\n        result => {\n          const bundle = result as Bundle;\n          if (bundle.entry !== undefined && bundle.entry.length > 0) {\n            console.log('Task found.');\n            this.tasks = [];\n            for (const entry of bundle.entry) {\n              if (entry.resource?.resourceType === 'Task') {\n                this.tasks.push(entry.resource as Task);\n              }\n            }\n            this.taskChange.emit({});\n          } else {\n            console.log('Task not found.');\n          }\n        }\n    );\n  }\n\n  public convertToTransaction(bundle: Bundle): any {\n\n    let newBundle: Bundle = {\n      resourceType : 'Bundle',\n      type : 'transaction',\n      entry : []\n    };\n    let task: any = {\n      resourceType : 'Task',\n      status: 'ready',\n      intent: 'order',\n      code: {\n        coding: [\n          {\n            system: 'http://hl7.org/fhir/CodeSystem/task-code',\n            code: 'fulfill',\n            display: 'Fulfill the focal request'\n          }\n        ]\n      },\n      input: []\n    };\n    let prescriptionorder = false;\n    if (bundle.entry !== undefined && bundle.entry.length > 0) {\n      let practitionerRole: string | undefined = '';\n      for (const entry of bundle.entry) {\n          const resource = entry.resource as any;\n          if (resource?.resourceType === 'Patient') {\n              task.for = {\n                reference : entry.fullUrl\n              };\n          }\n        if (resource?.resourceType === 'MessageHeader' ) {\n          console.log('MessageHeader');\n          const medicationHeader = resource as MessageHeader;\n          if (medicationHeader.eventCoding?.code === 'prescription-order') {\n            prescriptionorder = true;\n          }\n        }\n        if (resource?.resourceType === 'MedicationDispense' ) {\n          console.log('MedicationDispene');\n          let medicationDispense = resource as MedicationDispense;\n          if (medicationDispense.subject?.identifier !== undefined) {\n            medicationDispense.subject.reference = 'Patient?identifier=' + medicationDispense.subject.identifier.system\n                + '|' + medicationDispense.subject.identifier.value;\n          }\n          if (medicationDispense.authorizingPrescription !== undefined && medicationDispense.authorizingPrescription.length > 0) {\n            for (let ident of medicationDispense.authorizingPrescription) {\n              if (ident.identifier !== undefined) {\n                ident.reference = 'MedicationRequest?identifier=' + ident.identifier.system\n                    + '|' + ident.identifier.value;\n              }\n            }\n          }\n        }\n        // tslint:disable-next-line:no-conditional-assignment\n          if ((resource?.resourceType === 'MedicationRequest') ) {\n            const medicationRequest = resource as any;\n            if (task.identifier === undefined) {\n              task.identifier = [];\n              task.identifier.push(medicationRequest.groupIdentifier as Identifier);\n            }\n            task.requester = medicationRequest.requester;\n            practitionerRole = medicationRequest.requester?.reference;\n            task.authoredOn = medicationRequest.authoredOn;\n            if (medicationRequest.dispenseRequest !== undefined && medicationRequest.dispenseRequest.performer !== undefined) {\n                task.owner = medicationRequest.dispenseRequest.performer;\n                task.status = 'requested';\n            }\n            const input = {\n              type: {\n                coding:  [\n                  {\n                    system: 'http://snomed.info/sct',\n                    code: '16076005',\n                    display: 'Prescription'\n                  }\n                ]\n              },\n              valueReference: {\n                type: 'MedicationRequest',\n                reference: entry.fullUrl,\n                display: medicationRequest?.medicationCodeableConcept?.coding[0].display\n              }\n            };\n            task.input?.push(input);\n          }\n          if (resource?.identifier !== undefined) {\n              let identifier = '';\n              if (resource?.identifier.length !== undefined) {\n                identifier = this.getIdentifier(resource?.identifier[0]);\n              } else {\n                identifier = this.getIdentifier(resource?.identifier);\n              }\n              // @ts-ignore\n              entry.request = {\n                method : 'PUT',\n                url: resource?.resourceType + '?identifier=' + identifier\n              };\n              newBundle.entry?.push(entry);\n          } else {\n            // remove resource\n          }\n\n      }\n      if (practitionerRole !== '') {\n        console.log(practitionerRole);\n        for (const entry of bundle.entry) {\n          if (entry.fullUrl === practitionerRole) {\n            const resource = entry.resource as DomainResource;\n\n            if (resource.resourceType === 'PractitionerRole') {\n                // @ts-ignore\n              task.requester.display = (resource as PractitionerRole).practitioner.display;\n                // @ts-ignore\n              if (task.requester.display === undefined) {\n                  // @ts-ignore\n                  task.requester.display = (resource as PractitionerRole).identifier[0].value;\n                }\n            }\n          }\n        }\n      }\n\n\n      if (prescriptionorder) {\n        console.log(task);\n        const entry: BundleEntry = {\n          resource : task,\n          request : {\n            method : 'PUT',\n            url: 'Task?identifier=' + this.getIdentifier(task.identifier[0])\n          }\n        };\n        newBundle.entry?.push(entry);\n      }\n      console.log(newBundle);\n      this.http.post(environment.nhsd, JSON.stringify(newBundle), { headers: this.getHeaders() }).subscribe(\n          (result) => {\n            console.log('done post to hapi');\n            console.log(result);\n            this.medicationChange.emit({});\n          },\n          error => {\n            this.error.emit(error.error);\n          }\n      );\n    } else {\n    }\n  }\n\n  getMedicationRequest(url: string) {\n    const headers = this.getHeaders();\n    this.http.get<any>(url, {'headers': headers}).subscribe(\n        medicationRequest => {\n          if (medicationRequest.resourceType === 'Bundle') {\n            console.log('Found a Bundle');\n            const bundle = medicationRequest as Bundle;\n            if (bundle.entry !== undefined && bundle.entry.length > 0) {\n\n              this.medicationRequests = [];\n              for (const entry of bundle.entry) {\n\n                if (entry.resource?.resourceType === 'MedicationRequest') {\n\n                  this.medicationRequests.push(entry.resource as MedicationRequest);\n                }\n              }\n            } else {\n              console.log('Medication not found.');\n            }\n            this.medicationRequest.emit(medicationRequest);\n          } else {\n            this.medicationRequest.emit(medicationRequest);\n          }\n        }\n    )\n  }\n  getMedicationDispense(url: string) {\n    const headers = this.getHeaders();\n    this.http.get<any>(environment.nhsd + '/MedicationDispense?prescription=' + url, {'headers': headers}).subscribe(\n        resource => {\n          const bundle: Bundle = resource as Bundle;\n          if (bundle.entry !== undefined) {\n            for (let entry of bundle.entry) {\n\n              if (entry.resource?.resourceType === 'MedicationDispense') {\n                this.medicationDispense.emit(entry.resource as MedicationDispense);\n              }\n            }\n          }\n        }\n    )\n  }\n\n  getHeaders(): HttpHeaders {\n\n    let headers = new HttpHeaders(\n    );\n\n    headers = headers.append('Content-Type', 'application/fhir+json');\n    headers = headers.append('Accept', 'application/fhir+json');\n    return headers;\n  }\n\n  getIdentifier(identifier: Identifier): string {\n    if (identifier.system !== undefined) {\n      return identifier.system + '|' + identifier.value;\n    } else {\n      return <string>identifier.value;\n    }\n  }\n}\n","import { Component, OnInit } from '@angular/core';\nimport {MatTableDataSource} from '@angular/material/table';\nimport {Task} from 'fhir/r4';\nimport {DatePipe} from \"@angular/common\";\nimport {FhirService} from \"../service/FhirService\";\nimport {MatDialog} from \"@angular/material/dialog\";\nimport {IDraggableRefs, TdDialogService} from \"@covalent/core/dialogs\";\nimport {DiaryEntryComponent} from \"../diary-entry/diary-entry.component\";\n\n@Component({\n  selector: 'app-gp-diary',\n  templateUrl: './gp-diary.component.html',\n  styleUrls: ['./gp-diary.component.scss']\n})\nexport class GpDiaryComponent implements OnInit {\n\n\n    datepipe: DatePipe = new DatePipe('en-GB');\n    displayedColumns: string[] = ['when', 'status', 'reason', 'notes'];\n\n    dataSource: any;\n    data: Task[] = [];\n\n\n  constructor(private fhir: FhirService,\n              private dialog: MatDialog,\n              private _dialogService: TdDialogService\n  ) { }\n\n  ngOnInit(): void {\n     this.dataSource = new MatTableDataSource <any>(this.data);\n     this.fhir.queryTasks();\n     this.fhir.taskChange.subscribe(() => {\n          this.dataSource = new MatTableDataSource(this.fhir.getTasks());\n      });\n  }\n  diary(): void {\n      const task: Task = {\n          status: 'ready',\n          intent: 'proposal',\n          resourceType: 'Task',\n          reasonCode: {\n              coding: [{\n                  code: '182836005'\n              }]\n          }\n      };\n\n      const {\n          matDialogRef,\n          dragRefSubject,\n      }: IDraggableRefs<DiaryEntryComponent> = this._dialogService.openDraggable({\n          component: DiaryEntryComponent,\n          dragHandleSelectors: ['mat-toolbar'],\n          config: {\n              panelClass: ['td-window-dialog'], // pass this class in to ensure certain css is properly added,\n              data : task\n          },\n      });\n\n      matDialogRef.componentInstance.closed.subscribe(() => matDialogRef.close());\n  }\n\n}\n","<mat-card>\n    <mat-card-header layout=\"row\" layout-align=\"start center\" flex>\n\n        <h2>GP Diary Entries (FHIR Task)</h2>\n        <span flex></span>\n        <button mat-mini-fab aria-label=\"Example icon button with a heart icon\" (click)=\"diary()\">\n            <mat-icon>note_add</mat-icon>\n        </button>\n    </mat-card-header>\n\n    <table mat-table [dataSource]=\"dataSource\"  width=\"100%\">\n\n        <!--- Note that these columns can be defined in any order.\n              The actual rendered columns are set as a property on the row definition\" -->\n\n        <ng-container matColumnDef=\"status\">\n            <th mat-header-cell *matHeaderCellDef [style.width.px]=\"80\"> Status </th>\n            <td mat-cell *matCellDef=\"let element\"> {{element.status}} </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"medications\">\n            <th mat-header-cell *matHeaderCellDef> Medications </th>\n            <td mat-cell *matCellDef=\"let element\">\n                <ul>\n                    <ng-template ngFor let-item [ngForOf]=\"element.input\" let-i=\"index\" >\n                        <li>{{item.valueReference.display}}</li>\n                    </ng-template>\n                </ul>\n            </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"pharmacy\">\n            <th mat-header-cell *matHeaderCellDef> Pharmacy </th>\n            <td mat-cell *matCellDef=\"let element\"> {{element.owner?.identifier.value}} </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"requester\">\n            <th mat-header-cell *matHeaderCellDef> Requester </th>\n            <td mat-cell *matCellDef=\"let element\"> {{element.requester.display}} </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"authored\">\n            <th mat-header-cell *matHeaderCellDef> Authored </th>\n            <td mat-cell *matCellDef=\"let element\"> {{datepipe.transform(element.authoredOn, 'dd MMM yyyy HH:mm') }} </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"when\">\n            <th mat-header-cell *matHeaderCellDef [style.width.px]=\"120\"> When </th>\n            <td mat-cell *matCellDef=\"let element\"> {{datepipe.transform(element.executionPeriod.start, 'dd MMM yyyy HH:mm') }} </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"reason\">\n            <th mat-header-cell *matHeaderCellDef [style.width.px]=\"240\"> Reason </th>\n            <td mat-cell *matCellDef=\"let element\"> {{element.reasonCode.coding[0].display }} </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"notes\">\n            <th mat-header-cell *matHeaderCellDef> Notes </th>\n            <td mat-cell *matCellDef=\"let element\">  </td>\n        </ng-container>\n\n        <!-- Symbol Column -->\n        <ng-container matColumnDef=\"order_number\">\n            <th mat-header-cell *matHeaderCellDef > Order No. </th>\n            <td mat-cell *matCellDef=\"let element\"> {{element.identifier[0].value}} </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"return_order\">\n            <th mat-header-cell *matHeaderCellDef [style.width.px]=\"120\"> Cancel </th>\n            <td mat-cell *matCellDef=\"let element\">\n                <button color=\"warn\" *ngIf=\"element.status == 'accepted'\" mat-icon-button><mat-icon>remove_shopping_cart</mat-icon>Cancel</button>\n            </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"view_order\">\n            <th mat-header-cell *matHeaderCellDef [style.width.px]=\"120\"> View Order  </th>\n            <td mat-cell *matCellDef=\"let element\">\n                <button color=\"accent\" mat-icon-button routerLink=\"/details/123453-ABCDFE-12345\" ><mat-icon>inventory</mat-icon>View Details</button>\n            </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"track_order\">\n            <th mat-header-cell *matHeaderCellDef [style.width.px]=\"120\"> Track Package  </th>\n            <td mat-cell *matCellDef=\"let element\">\n                <button color=\"accent\" mat-icon-button routerLink=\"/details/123453-ABCDFE-12345\" ><mat-icon>local_shipping</mat-icon>Tracking</button>\n            </td>\n        </ng-container>\n\n        <tr mat-header-row *matHeaderRowDef=\"displayedColumns\"></tr>\n        <tr mat-row *matRowDef=\"let row; columns: displayedColumns;\"></tr>\n    </table>\n</mat-card>\n","import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport {MainComponent} from './main/main.component';\nimport {OrdersComponent} from './orders/orders.component';\nimport {CallbackComponent} from './callback/callback.component';\nimport {AuthGuard} from './service/auth-guard';\nimport {LoginComponent} from './login/login.component';\n\nconst routes: Routes = [\n  { path: '', canActivate: [AuthGuard], component: MainComponent,\n    children : [\n      {\n        path: '', component: OrdersComponent\n      }]},\n  {  path: 'callback', component : CallbackComponent},\n  {  path: 'login', component : LoginComponent}\n];\n\n@NgModule({\n  imports: [RouterModule.forRoot(routes)],\n  exports: [RouterModule]\n})\nexport class AppRoutingModule { }\n","import { Component, OnInit } from '@angular/core';\nimport {environment} from '../../environments/environment';\n\n@Component({\n  selector: 'app-login',\n  templateUrl: './login.component.html',\n  styleUrls: ['./login.component.scss']\n})\nexport class LoginComponent implements OnInit {\n\n  constructor() { }\n  callback = document.baseURI + 'callback';\n\n\n  ngOnInit(): void {\n    // window.location.href = environment.oauth2.auth + '?client_id=' + environment.oauth2.client_id +\n    //    '&response_type=code&redirect_uri=' + this.callback + '&state=123';\n  }\n\n}\n","Redirecting to login\n","import { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'app-main',\n  templateUrl: './main.component.html',\n  styleUrls: ['./main.component.scss']\n})\nexport class MainComponent implements OnInit {\n\n  opened = false;\n  constructor() { }\n\n  ngOnInit(): void {\n  }\n\n}\n","<mat-menu #menu=\"matMenu\">\n    <button mat-menu-item routerLink=\"/order\"><mat-icon>shopping_basket</mat-icon>My Tasks</button>\n    <button mat-menu-item routerLink=\"/search\"><mat-icon>add_shopping_cart</mat-icon>Search and Add Tasks</button>\n    <button mat-menu-item routerLink=\"/refill\"><mat-icon>reorder</mat-icon>Reorder Medications</button>\n</mat-menu>\n<mat-menu #dosmenu=\"matMenu\">\n    <button mat-menu-item routerLink=\"/patient\"><mat-icon>person</mat-icon>Patient</button>\n    <button mat-menu-item routerLink=\"/pharmacy\"><mat-icon>store</mat-icon>Pharmacy</button>\n</mat-menu>\n<td-layout class=\"layout-nav-demo\" sidenavWidth=\"280px\">\n    <td-navigation-drawer\n            flex\n            sidenavTitle=\"Menu\" >\n        <mat-list>\n        </mat-list>\n        <span>\n    </span>\n    </td-navigation-drawer>\n    <td-layout-nav-list navigationRoute=\"/\" mode=\"side\" [opened]=opened>\n\n        <div td-sidenav-content>\n\n\n        </div>\n        <div td-toolbar-content layout=\"row\" layout-align=\"start center\" flex>\n\n           <!-- <button mat-icon-button td-menu-button tdLayoutToggle>\n                <mat-icon>menu</mat-icon>\n            </button>\n-->\n            <span>Codename: Danube</span>\n            <span flex></span>\n\n           <!-- <button mat-icon-button [matMenuTriggerFor]=\"dosmenu\" matTooltip=\"Directory Services\"><mat-icon>search</mat-icon><mat-icon>arrow_drop_down</mat-icon></button>\n-->\n            <button mat-button  matTooltip=\"Orders\"><mat-icon>add_shopping_cart</mat-icon>Basket</button>\n\n        </div>\n        <router-outlet></router-outlet>\n    </td-layout-nav-list>\n</td-layout>\n","import {Component, Input, OnInit} from '@angular/core';\nimport {MatTableDataSource} from '@angular/material/table';\nimport {FhirService} from '../service/FhirService';\nimport {MedicationRequest, Task} from 'fhir/r4';\nimport {DatePipe} from '@angular/common';\nimport {MatDialog, MatDialogConfig} from \"@angular/material/dialog\";\nimport {\n    IDraggableRefs,\n    ResizableDraggableDialog,\n    TdDialogService,\n    TdPromptDialogComponent\n} from \"@covalent/core/dialogs\";\nimport {DiaryEntryComponent} from \"../diary-entry/diary-entry.component\";\nimport {TrackingComponent} from \"../tracking/tracking.component\";\nimport {NhsdService} from \"../service/nhsd.service\";\nimport {environment} from \"../../environments/environment\";\n\n\n\n@Component({\n  selector: 'app-prescription-refill',\n  templateUrl: './prescription-refill.component.html',\n  styleUrls: ['./prescription-refill.component.scss']\n})\nexport class PrescriptionRefillComponent implements OnInit {\n\n    @Input()\n    source: string = 'GP';\n\n    displayedColumns: string[] = ['authored', 'status', 'name',  'courseOfTherapy',  'quantity', 'unit', 'reorder_medication', 'track_order'];\n\n    dataSource: any;\n\n    data: MedicationRequest[] =  [];\n\n    datepipe: DatePipe = new DatePipe('en-GB');\n\n\n  constructor(private fhir: FhirService,\n              private nhsd: NhsdService,\n              private dialog: MatDialog,\n              private _dialogService: TdDialogService) { }\n\n  ngOnInit(): void {\n      this.dataSource = new MatTableDataSource <any>(this.data);\n      if (this.source == 'GP') {\n          this.fhir.queryMedicationRequests();\n          this.fhir.medicationChange.subscribe(() => {\n\n              this.dataSource = new MatTableDataSource(this.fhir.getMedicationRequests());\n          });\n      }\n      if (this.source == 'EPS') {\n          this.nhsd.getMedicationRequest(environment.nhsd + '/MedicationRequest?patient.identifier=9876543210');\n          this.nhsd.medicationRequest.subscribe(() => {\n\n              this.dataSource = new MatTableDataSource(this.nhsd.getMedicationRequests());\n          });\n      }\n  }\n\n  tracking(event: any): void {\n      const {\n          matDialogRef,\n          dragRefSubject,\n      }: IDraggableRefs<TrackingComponent> = this._dialogService.openDraggable({\n          component: TrackingComponent,\n          dragHandleSelectors: ['mat-toolbar'],\n          config: {\n              panelClass: ['td-window-dialog'], // pass this class in to ensure certain css is properly added,\n          },\n      });\n\n      matDialogRef.componentInstance.closed.subscribe(() => matDialogRef.close());\n  }\n\n  refill(resource: MedicationRequest): void {\n\n      const task: Task = {\n          status: 'ready',\n          intent: 'proposal',\n          resourceType: 'Task',\n          reasonCode: {\n              coding: [{\n                  code: '103742009'\n              }]\n          }\n      };\n      if (resource.medicationCodeableConcept !== undefined\n          && resource.medicationCodeableConcept.coding !== undefined\n          && resource.medicationCodeableConcept.coding[0].display !== undefined) {\n          // @ts-ignore\n          task.note = [\n              {\n                  text: resource.medicationCodeableConcept.coding[0].display\n                      + ' ('+  this.datepipe.transform(resource.authoredOn, 'dd MMM yyyy') +  ')'\n              }\n          ]\n      }\n\n      const {\n          matDialogRef,\n          dragRefSubject,\n      }: IDraggableRefs<DiaryEntryComponent> = this._dialogService.openDraggable({\n          component: DiaryEntryComponent,\n          dragHandleSelectors: ['mat-toolbar'],\n          config: {\n              panelClass: ['td-window-dialog'], // pass this class in to ensure certain css is properly added,\n              data : task\n          },\n      });\n\n      matDialogRef.componentInstance.closed.subscribe(() => matDialogRef.close());\n  }\n\n}\n","<mat-card>\n    <mat-card-header><h2>{{source}} Medication Record (FHIR MedicationRequest)</h2></mat-card-header>\n    <table mat-table [dataSource]=\"dataSource\"  width=\"100%\">\n\n        <!--- Note that these columns can be defined in any order.\n              The actual rendered columns are set as a property on the row definition\" -->\n\n        <!-- Position Column -->\n        <ng-container matColumnDef=\"concept\">\n            <th mat-header-cell *matHeaderCellDef> Medication ID </th>\n            <td mat-cell *matCellDef=\"let element\"> {{element.concept}} </td>\n        </ng-container>\n\n        <!-- Name Column -->\n        <ng-container matColumnDef=\"name\">\n            <th mat-header-cell *matHeaderCellDef [style.width.px]=\"240\"> Medication Name </th>\n            <td mat-cell *matCellDef=\"let element\"> {{element.medicationCodeableConcept.coding[0].display}} </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"status\">\n            <th mat-header-cell *matHeaderCellDef [style.width.px]=\"80\"> Status </th>\n            <td mat-cell *matCellDef=\"let element\"> {{element.status}}  </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"authored\">\n            <th mat-header-cell *matHeaderCellDef [style.width.px]=\"120\"> Authored </th>\n            <td mat-cell *matCellDef=\"let element\"> {{datepipe.transform(element.authoredOn, 'dd MMM yyyy') }} </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"unit\">\n            <th mat-header-cell *matHeaderCellDef [style.width.px]=\"80\"> Unit </th>\n            <td mat-cell *matCellDef=\"let element\"> {{element.dispenseRequest.quantity.unit}} </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"quantity\">\n            <th mat-header-cell *matHeaderCellDef [style.width.px]=\"80\"> Quantity </th>\n            <td mat-cell *matCellDef=\"let element\"> {{element.dispenseRequest.quantity.value}} </td>\n        </ng-container>\n\n\n        <ng-container matColumnDef=\"courseOfTherapy\">\n            <th mat-header-cell *matHeaderCellDef [style.width.px]=\"200\"> Type </th>\n            <td mat-cell *matCellDef=\"let element\"> {{element.courseOfTherapyType.coding[0].display}} </td>\n        </ng-container>\n\n        <!-- Symbol Column -->\n\n        <ng-container matColumnDef=\"reorder_medication\">\n            <th mat-header-cell *matHeaderCellDef [style.width.px]=\"120\"> Reorder </th>\n            <td mat-cell *matCellDef=\"let element\">\n                <span *ngIf=\"element.courseOfTherapyType.coding[0].code === 'continuous'\">\n                    <button color=\"accent\" mat-icon-button (click)=\"refill(element)\"><mat-icon>add_shopping_cart</mat-icon>Reorder</button>\n                </span>\n            </td>\n        </ng-container>\n\n        <ng-container matColumnDef=\"track_order\">\n            <th mat-header-cell *matHeaderCellDef [style.width.px]=\"120\"> Tracking  </th>\n            <td mat-cell *matCellDef=\"let element\">\n                <button color=\"accent\" mat-icon-button (click)=\"tracking(element)\"><mat-icon>local_shipping</mat-icon>Tracking</button>\n            </td>\n        </ng-container>\n\n        <tr mat-header-row *matHeaderRowDef=\"displayedColumns\"></tr>\n        <tr mat-row *matRowDef=\"let row; columns: displayedColumns;\"></tr>\n    </table>\n\n</mat-card>\n","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule)\n  .catch(err => console.error(err));\n","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"zn8P\";"]}